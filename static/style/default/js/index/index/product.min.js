"use strict";function changeOrder(t,a,i,e){var s="<dd><label>出发日期：</label>"+a+'</dd><dd><label>成人价：</label><span class="ycolor">￥'+i+'</span>/人</dd><dd><label>儿童价：</label><span class="ycolor">￥'+e+'</span>/儿童</dd><dd><label>成人数：</label> <div class="num_view" data-type="child"><a href="javascript:;" class="min">-</a><span>1</span><a href="javascript:;" class="add">+</a><input type="hidden" id="adult" value="1"></div></dd><dd><label>儿童数：</label> <div class="num_view" data-type="adult"><a href="javascript:;" class="min">-</a><span>0</span><a href="javascript:;" class="add">+</a><input type="hidden" id="child" value="0"></div></dd>';t.html(s),numFun.init($(".num_view"))}function changeplane(t){var a=$(".prod_plane_info");$.ajax({url:$("#planeUrl").val(),type:"post",dataType:"json",data:{id:t}}).done(function(t){if(0==t.errno){var i="";$.each(t.ticket,function(t,a){i+='<div class="list"><ul>',0==a.type?i+='<li class="plane_type">去程</li>':1==a.type&&(i+='<li class="plane_type">返程</li>'),i+='<li class="plane_name"><p class="f14 mt5">'+a.company+"</p><p>"+a.time+"</p></li>",i+='<li class="plane_time"><p class="f14 b mt10">'+a.go_area+'</p><p class="f24 b mt10">'+a.go_time+'</p><p class="f14">'+a.go_airport+"</p></li>",i+='<li class="plane_img"></li>',i+='<li class="plane_time"><p class="f14 b mt10">'+a.return_area+'</p><p class="f24 b mt10">'+a.return_time+'</p><p class="f14">'+a.return_airport+"</p></li>",i+='<li class="plane_total"><p class="time_c mt5">航行时间</p><p>'+a.spend_time+"</p></li>",i+="</ul></div>"}),a.html(i)}})}!function(){function t(t,a){this.dom=$('<div class="calendar_box"></div>'),this.w=t.width(),this.prevBtn=$('<div class="calendar_prev"></div>'),this.nextBtn=$('<div class="calendar_next"></div>'),this.page=0,this.data=a,this.handle(),t.append(this.dom).append(this.prevBtn).append(this.nextBtn);var i=$(".calendar").length,e=this;this.dom.width(this.w*i),2>i?(this.prevBtn.addClass("none"),this.nextBtn.addClass("none")):i>=2&&this.prevBtn.addClass("none"),this.prevBtn.click(function(){return $(this).hasClass("none")?!1:void e.prev()}),this.nextBtn.click(function(){return $(this).hasClass("none")?!1:void e.next(i)})}t.prototype.handle=function(){var t=this.data,a=this;for(var i in t){var e=t[i].year_month.split("-"),s=parseInt(e[0],10),n=parseInt(e[1],10)-1,l=new Date(s,n,1,0,0,0),d=new Date(s,n+1,0,0,0,0),o=new Date,r=o.getFullYear()+"-"+(o.getMonth()<9?"0"+(o.getMonth()+1):o.getMonth()+1)+"-"+(o.getDate()<10?"0"+o.getDate():o.getDate());a.create(t[i].year_month_days,r,l.getDay(),d.getDate(),t[i].year_month)}},t.prototype.create=function(t,a,i,e,s){for(var n=this,l=$('<div class="calendar" data-month='+s+"></div>"),d=$('<div class="title">'+s+"</div>"),o=$('<ul class="week_ul"><li>日</li><li>一</li><li>二</li><li>三</li><li>四</li><li>五</li><li>六</li></ul>'),r=$('<ul class="day_ul"></ul>'),p="",c=1;42>=c;c++)if(i>=c)p+="<li></li>";else if(c>=i&&e+i>=c){var h=c-i,f=s+"-"+n.rDay(h),v="";$.each(t,function(t,a){a.year_month_day==f&&(v='<li class="has on" data-info='+f+","+a.price+","+a.child_price+","+a.id+","+a.stock+'><p class="text">'+h+'</p><p class="stock">剩余：'+a.stock+'</p><p class="price">￥'+a.price+"</p></li>")}),v?(p+=v,v=""):p+='<li class="has"><p class="text">'+h+"</p></li>"}else p+="<li></li>";r.html(p),l.append(d).append(o).append(r),n.dom.append(l)},t.prototype.rDay=function(t){return 9>=t?"0"+t:""+t},t.prototype.prev=function(){this.page--,this.dom.css("left","-"+this.w*this.page+"px"),this.nextBtn.hasClass("none")&&this.nextBtn.removeClass("none"),this.page<=0&&this.prevBtn.addClass("none")},t.prototype.next=function(t){this.page++,this.dom.css("left","-"+this.w*this.page+"px"),this.prevBtn.hasClass("none")&&this.prevBtn.removeClass("none"),this.page+1>=t&&this.nextBtn.addClass("none")},window.calendar=t}(),function(){function t(t,a){var i=this;this.addBtn=t.find(".add"),this.minBtn=t.find(".min"),this.text=t.find("span"),this.zNum=t.find("input"),this.oNum=$("#"+a),this.stockVal=$("#prodStock").val(),this.addBtn.click(function(){var t=parseInt(i.zNum.val()),a=parseInt(i.oNum.val());t+a<i.stockVal&&i.add()}),this.minBtn.click(function(){var t=parseInt(i.zNum.val());"child"==a?t>1&&i.min():t>0&&i.min()})}t.prototype.add=function(){var t=this.zNum.val();t++,this.zNum.val(t),this.text.text(t)},t.prototype.min=function(){var t=this.zNum.val();t--,this.zNum.val(t),this.text.text(t)},t.init=function(t){var a=this;t.each(function(){var t=$(this).data("type");new a($(this),t)})},window.numFun=t}(),$(".prod_slide .bd li").first().before($(".prod_slide .bd li").last()),$(".prod_slide").slide({mainCell:".bd ul",effect:"leftLoop",autoPlay:!0,vis:3}),$.ajax({url:$("#calendarUrl").val(),type:"post",dataType:"json",data:{id:$("#id").val()}}).done(function(t){if(0==t.errno){var a=t.items;new calendar($(".prod_calenda"),a)}}),$(".daywayback").each(function(){var t=new RegExp("\\[(.+?)\\]","g"),a=$(this).html(),i=a.replace(t,'<i class="tripicon $1"></i>');$(this).html(i)}),numFun.init($(".num_view")),$(".prod_calenda").on("click",".on",function(){var t=$(this).data("info").split(","),a=t[0],i=t[1],e=t[2],s=t[3],n=t[4];$("#prodTime").val(a),$("#prodAdultPrice").val(i),$("#prodChildPrice").val(e),$("#prodId").val(s),$("#prodStock").val(n),$(".prod_detail").find("h1").html("￥"+i),changeOrder($("#orderInfo"),a,i,e),changeplane(s)});var order=$(".order"),orderTop=order.offset().top,prodTabTitle=$(".prod_tab_title"),prodTabTitleTop=prodTabTitle.offset().top,dayList=$(".day_list"),dayListTop=dayList.offset().top;$(window).scroll(function(){var t=$(document).scrollTop();t>=orderTop?order.addClass("tag_fixed"):order.removeClass("tag_fixed"),t>=prodTabTitleTop?prodTabTitle.addClass("tag_fixed"):prodTabTitle.removeClass("tag_fixed"),t>=dayListTop-100&&t<=dayListTop+$(".prod_tab_trip").outerHeight()-500?dayList.find("div").addClass("tag_fixed"):dayList.find("div").removeClass("tag_fixed");var a=0;prodTabTitle.find("li").each(function(i){t>=$(".prod_tab_info>div").eq(i).offset().top-45&&(a=i)}),prodTabTitle.find("li").eq(a).addClass("select").siblings().removeClass("select");var i=0;dayList.find("a").each(function(a){t>=$(".trip_list").eq(a).offset().top-60&&(i=a)}),dayList.find("a").eq(i).addClass("current").siblings().removeClass("current")}),prodTabTitle.find("li").click(function(){var t=$(this).index();$("html,body").animate({scrollTop:$(".prod_tab_info>div").eq(t).offset().top-45},500)}),dayList.find("a").click(function(){var t=$(this).index();$("html,body").animate({scrollTop:$(".trip_list").eq(t).offset().top-60},500)}),$("#reserve").click(function(){var t=$(".down_img");"none"==t.css("display")?t.fadeIn():t.fadeOut()}),$("#collect").click(function(){var t=$(this),a=$("#collectUrl").val();$.post(a,{dataid:$("#id").val()},function(a){0==a.errno?t.toggleClass("has"):layer.alert(a.errmsg)},"json")});var jiathis_config={siteNum:3,sm:"weixin,qzone,tsina",summary:"",boldNum:3,shortUrl:!1,hideMore:!0};